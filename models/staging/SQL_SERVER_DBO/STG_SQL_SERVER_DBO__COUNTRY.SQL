
{{
  config(
    MATERIALIZED = 'VIEW'
  )
}}

WITH SRC_ADDRESSES AS (
    SELECT DISTINCT(COUNTRY) AS COUNTRY_NAME
    FROM {{ source('SQL_SERVER_DBO', 'ADDRESSES') }}
    ),

RENAMED_COUNTRY AS (
    SELECT
        MD5(LOWER(COUNTRY_NAME)) AS COUNTRY_ID,
        COUNTRY_NAME
    FROM SRC_ADDRESSES
    )

SELECT * FROM RENAMED_COUNTRY