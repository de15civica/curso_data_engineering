
{{
  config(
    MATERIALIZED = 'VIEW'
  )
}}

WITH SRC_ORDERS AS (
    SELECT DISTINCT(SHIPPING_SERVICE) AS SHIPPING_SERVICE_NAME 
    FROM {{ source('SQL_SERVER_DBO', 'ORDERS') }}
    ),

RENAMED_SHIPPING_SERVICE AS (
    SELECT
        --MD5(LOWER(SHIPPING_SERVICE_NAME)) AS SHIPPING_SERVICE_ID,
        {{ dbt_utils.generate_surrogate_key(['SHIPPING_SERVICE_NAME']) }} AS SHIPPING_SERVICE_ID,
        SHIPPING_SERVICE_NAME
    FROM SRC_ORDERS
    -- WHERE SHIPPING_SERVICE_NAME != ''
    )

SELECT * FROM RENAMED_SHIPPING_SERVICE