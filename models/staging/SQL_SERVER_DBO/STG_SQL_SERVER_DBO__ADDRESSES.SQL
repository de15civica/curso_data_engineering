
{{
  config(
    MATERIALIZED = 'VIEW'
  )
}}

WITH SRC_ADDRESSES AS (
    SELECT * 
    FROM {{ source('SQL_SERVER_DBO', 'ADDRESSES') }}
    ),

RENAMED_ADDRESSES AS (
    SELECT
        ADDRESS_ID,
        ADDRESS,
        ZIPCODE,
        STATE,
        COUNTRY,
        _FIVETRAN_DELETED AS IS_ROW_DELETED,
        CONVERT_TIMEZONE('UTC', _FIVETRAN_SYNCED) AS DATETIME_ROW_LOADED
    FROM SRC_ADDRESSES
    )

SELECT * FROM RENAMED_ADDRESSES